<div class="container" style="margin-top:30px">
    <form style="margin-top:40px" action="/home/write" method="POST">
      <div class="form-group">
        <label for="exampleInputPassword1">Title</label>
        <input name="title" type="text" class="form-control" id="exampleInputPassword1" placeholder="제목">
      </div>
      <label for="exampleInputPassword1">Content</label>
      <textarea class="form-control" rows="5" id="content" name="content"></textarea>
      <button type="submit" class="btn btn-default">등록</button>
    </form>
    
     
      <% @posts.each do |p| %>
          <div class="well">
              <span style="font-weight:bold"><%= p.title %></span><br>
              <%= p.content %><br>
              <%= p.created_at %><br>
              글자수(공백포함) : <%= p.length %><br>
              글자수(공백미포함) : <%= p.length-p.count %><br>
              단어수 : <%= p.count+1 %><br>
              <div id="reply_<%= p.id %>">   
                  <% p.replies.each do |r| %>
                      <%= r.content %><br> 
                  <% end %>
              </div>
                    <label for="exampleInputPassword1">Reply</label>
                    
                   
                    <textarea class="form-control" rows="2" id="content_<%= p.id %>" name="content"></textarea>
                    <button value="<%= p.id %>" type="submit" class="btn btn-default reply_submit">등록</button>
                  
          </div>
      <% end %>
    
</div>

<script>
//reply_submit이 클릭이 되면 script를 돌린다.
$(function(){ //페이지가 다 로딩된 후에 jquery를 읽게 해야 한다. 반드시
    $('.reply_submit').click(function(){
      
        post_id=this.value;
        post_content=$("#content_" + post_id).val();
        
        $.ajax({
          method: "POST",
          url: "/home/reply_write",
          data: { content: post_content, id_of_post: post_id},
            success: function(){
              $("#reply_" + post_id).append("<p>" + post_content +"</p>" );
              $("#content_" + post_id).val('');
            
            },
            error: function(){
              alert( "댓글이 작성되지 않았습니다.");
            }
        })
    });
});
 </script>